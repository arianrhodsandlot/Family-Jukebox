define(['_'], function (_) {
  var x75p = function (notes) {
    return _.map(notes, function (note) {
      return _.isArray(note) ? [note[0], note[1] * 0.75] : [note, 0.75]
    })
  }

  var prelude = [[null, 128]]

  var overtune = x75p([
    [-14, 2], -2, [-4, 2], -7, -10, -12, -14, null, -14, [null, 5], [-21, 3]
  ])

  var verse = x75p([
    [-17, 2], -17, [-14, 2],
    [-16, 3], [-12, 2], -12, [-9, 2],
    [-14, 3], [-10, 2], -10, [-7, 2],
    [-21, 3], [-17, 2], -17, [-14, 2],

    [-21, 3], [-17, 2], -17, [-14, 2],
    [-16, 3], [-12, 2], -12, [-9, 2],
    [-14, 3], [-10, 2], -10, [-7, 2],
    [-21, 3], [-17, 2], -17, [-14, 2],

    [-16, 2], -16, [-13, 2], -13, [-9, 2],
    [-21, 2], -21, [-17, 2], -17, [-14, 2],
    [-16, 2], -16, [-13, 2], -13, [-9, 2],
    [-21, 2], -21, [-17, 2], -17, [-14, 2],

    [-16, 2], -16, [-13, 2], -13, [-9, 2],
    [-17, 2], -17, [-14, 2], -14, [-9, 2],
    [-18, 2], -18, [-14, 2], -14, [-9, 2],
    [-19, 2], -19, [-14, 2], -14, [-14, 2]
  ])

  var chorus = x75p([
    [-9, 2], -14, [-9, 2], -14, [-9, 2],
    [-10, 2], -14, [-10, 2], -14, [-10, 2],
    [-11, 2], -14, [-11, 2], -14, [-11, 2],
    [-12, 2], -16, [-12, 2], -16, [-12, 2],

    [-13, 2], -16, [-13, 2], -16, [-13, 2],
    [-14, 2], -17, [-14, 2], -17, [-14, 2],
    [-15, 2], -19, [-15, 2], -19, [-15, 2],
    [-14, 2], -17, [-14, 2], -17, [-14, 2],

    [-9, 2], -14, [-9, 2], -14, [-9, 2],
    [-10, 2], -14, [-10, 2], -14, [-10, 2],
    [-11, 2], -14, [-11, 2], -14, [-11, 2],
    [-12, 2], -16, [-12, 2], -16, [-12, 2],

    [-13, 2], -16, [-13, 2], -16, [-13, 2],
    [-14, 2], -17, [-14, 2], -17, [-14, 2],
    [-15, 2], -19, [-15, 2], -19, [-15, 2],
    [-14, 2], -17, [-14, 2], -17, [-14, 2],

    [-21, 3]
  ])

  var notes = prelude
    .concat(overtune)
    .concat(verse)
    .concat(chorus)
    .concat(verse)
    .concat(chorus)

  return {
    name: 'triangle',
    waveform: 'triangle',
    config: {
      instrument: {
        sampleRate: 44100,
        bpm: 233,
        fadeOut: {
          from: 0.8,
          to: 1
        }
      },
      audio: {
        volume: 0.2,
      }
    },
    notes: notes
  }
})
